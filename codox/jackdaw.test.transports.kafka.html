<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>jackdaw.test.transports.kafka documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Jackdaw</span> <span class="project-version">0.6.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="test-machine.html"><div class="inner"><span>The Test Machine</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jackdaw</span></div></div></li><li class="depth-2 branch"><a href="jackdaw.admin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>admin</span></div></a></li><li class="depth-2"><a href="jackdaw.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.client.log.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>log</span></div></a></li><li class="depth-3"><a href="jackdaw.client.partitioning.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>partitioning</span></div></a></li><li class="depth-2 branch"><a href="jackdaw.data.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-2"><a href="jackdaw.serdes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>serdes</span></div></a></li><li class="depth-3"><a href="jackdaw.serdes.avro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>avro</span></div></a></li><li class="depth-4 branch"><a href="jackdaw.serdes.avro.confluent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>confluent</span></div></a></li><li class="depth-4"><a href="jackdaw.serdes.avro.schema-registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema-registry</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.serdes.edn.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>edn</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.serdes.fn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fn</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.serdes.fn-impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fn-impl</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.serdes.json.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>json</span></div></a></li><li class="depth-3"><a href="jackdaw.serdes.resolver.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resolver</span></div></a></li><li class="depth-2 branch"><a href="jackdaw.specs.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2"><a href="jackdaw.streams.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>streams</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.configurable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>configurable</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.configured.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>configured</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.extras.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extras</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.interop.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interop</span></div></a></li><li class="depth-3"><a href="jackdaw.streams.lambdas.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lambdas</span></div></a></li><li class="depth-4"><a href="jackdaw.streams.lambdas.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.mock.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>mock</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-3"><a href="jackdaw.streams.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2"><a href="jackdaw.test.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-3"><a href="jackdaw.test.commands.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>commands</span></div></a></li><li class="depth-4 branch"><a href="jackdaw.test.commands.base.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>base</span></div></a></li><li class="depth-4 branch"><a href="jackdaw.test.commands.watch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>watch</span></div></a></li><li class="depth-4"><a href="jackdaw.test.commands.write.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>write</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.test.fixtures.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.test.journal.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>journal</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.test.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.test.serde.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>serde</span></div></a></li><li class="depth-3"><a href="jackdaw.test.transports.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transports</span></div></a></li><li class="depth-4 branch"><a href="jackdaw.test.transports.identity.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>identity</span></div></a></li><li class="depth-4 branch current"><a href="jackdaw.test.transports.kafka.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kafka</span></div></a></li><li class="depth-4 branch"><a href="jackdaw.test.transports.mock.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mock</span></div></a></li><li class="depth-4"><a href="jackdaw.test.transports.rest-proxy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rest-proxy</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-build-record"><div class="inner"><span>build-record</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-close-consumer"><div class="inner"><span>close-consumer</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-consumer"><div class="inner"><span>consumer</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-deliver-ack"><div class="inner"><span>deliver-ack</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-load-assignments"><div class="inner"><span>load-assignments</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-mk-consumer-record"><div class="inner"><span>mk-consumer-record</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-mk-producer-record"><div class="inner"><span>mk-producer-record</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-poller"><div class="inner"><span>poller</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-producer"><div class="inner"><span>producer</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-seek-to-end"><div class="inner"><span>seek-to-end</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-subscribe"><div class="inner"><span>subscribe</span></div></a></li><li class="depth-1"><a href="jackdaw.test.transports.kafka.html#var-subscription"><div class="inner"><span>subscription</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">jackdaw.test.transports.kafka</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-build-record"><h3>build-record</h3><div class="usage"><code>(build-record m)</code></div><div class="doc"><pre class="plaintext">Builds a Kafka Producer and assoc it onto the message map
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L132">view source</a></div></div><div class="public anchor" id="var-close-consumer"><h3>close-consumer</h3><div class="usage"><code>(close-consumer consumer)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L127">view source</a></div></div><div class="public anchor" id="var-consumer"><h3>consumer</h3><div class="usage"><code>(consumer kafka-config topic-metadata deserializers)</code></div><div class="doc"><pre class="plaintext">Creates an asynchronous Kafka Consumer of all topics defined in the
supplied `topic-metadata`

Puts all messages on the channel in the returned response. It is the
responsibility of the caller to arrange for the read the channel to
be read by some other process.

Must be closed with `close-consumer` when no longer required</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L89">view source</a></div></div><div class="public anchor" id="var-deliver-ack"><h3>deliver-ack</h3><div class="usage"><code>(deliver-ack ack)</code></div><div class="doc"><pre class="plaintext">Deliver the `ack` promise with the result of attempting to write to kafka. The
default command-handler waits for this before on to the next command so the
test response may indicate the success/failure of each write command.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L142">view source</a></div></div><div class="public anchor" id="var-load-assignments"><h3>load-assignments</h3><div class="usage"><code>(load-assignments consumer)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L26">view source</a></div></div><div class="public anchor" id="var-mk-consumer-record"><h3>mk-consumer-record</h3><div class="usage"><code>(mk-consumer-record consumer-record)</code></div><div class="doc"><pre class="plaintext">Clojurize the ConsumerRecord returned from consuming a kafka record
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L64">view source</a></div></div><div class="public anchor" id="var-mk-producer-record"><h3>mk-producer-record</h3><div class="usage"><code>(mk-producer-record {:keys [topic-name]} value)</code><code>(mk-producer-record {:keys [topic-name]} key value)</code><code>(mk-producer-record {:keys [topic-name]} partition key value)</code><code>(mk-producer-record {:keys [topic-name]} partition timestamp key value)</code></div><div class="doc"><pre class="plaintext">Creates a kafka ProducerRecord for use with `send!`.
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L78">view source</a></div></div><div class="public anchor" id="var-poller"><h3>poller</h3><div class="usage"><code>(poller messages)</code></div><div class="doc"><pre class="plaintext">Returns a function that takes a consumer and puts any messages retrieved
by polling it onto the supplied `messages` channel</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L42">view source</a></div></div><div class="public anchor" id="var-producer"><h3>producer</h3><div class="usage"><code>(producer kafka-config topic-config serializers)</code></div><div class="doc"><pre class="plaintext">Creates an asynchronous kafka producer to be used by a test-machine for for
injecting test messages</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L156">view source</a></div></div><div class="public anchor" id="var-seek-to-end"><h3>seek-to-end</h3><div class="usage"><code>(seek-to-end consumer &amp; topic-partitions)</code></div><div class="doc"><pre class="plaintext">Seeks to the end of all the partitions assigned to the given consumer
and returns the updated consumer</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L31">view source</a></div></div><div class="public anchor" id="var-subscribe"><h3>subscribe</h3><div class="usage"><code>(subscribe consumer topic-config)</code></div><div class="doc"><pre class="plaintext">Subscribes to specified topics

`consumer` should be a kafka consumer
`topic-config` should be a sequence of topic-metadata maps</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L18">view source</a></div></div><div class="public anchor" id="var-subscription"><h3>subscription</h3><div class="usage"><code>(subscription kafka-config topic-collection)</code></div><div class="doc"><pre class="plaintext">Subscribes to `topic-collection` and seeks to the end of all partitions. This
is usually what you want in a testing context. It's best for the test you're
trying to run now to ignore all the garbage created by previous tests.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.6.0/src/jackdaw/test/transports/kafka.clj#L55">view source</a></div></div></div></body></html>
